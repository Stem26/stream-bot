#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
echo "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–≤..."

# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /root/stream-bot || exit 1

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ git
echo "üì• Git pull..."
git pull origin main

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
npm install

# –°–±–æ—Ä–∫–∞ –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
echo "üî® –°–±–æ—Ä–∫–∞ Telegram —Å–µ—Ä–≤–∏—Å–∞..."
npm run build:telegram

echo "üî® –°–±–æ—Ä–∫–∞ Twitch —Å–µ—Ä–≤–∏—Å–∞..."
npm run build:twitch

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ PM2
echo "‚ôªÔ∏è  –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–æ–≤..."
pm2 restart all

# –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
echo "‚úÖ –ì–æ—Ç–æ–≤–æ!"
pm2 list
